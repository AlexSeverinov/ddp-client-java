<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Meteor DDP Client for Java : Event-driven Meteor integration for the JRE." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Meteor DDP Client for Java</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/sailorgeoffrey/ddp-client-java">View on GitHub</a>

          <h1 id="project_title">Meteor DDP Client for Java</h1>
          <h2 id="project_tagline">Event-driven Meteor integration for the JRE.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/sailorgeoffrey/ddp-client-java/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/sailorgeoffrey/ddp-client-java/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="meteor-ddp-client-for-java--" class="anchor" href="#meteor-ddp-client-for-java--"><span class="octicon octicon-link"></span></a>Meteor DDP Client for Java  <a href="https://travis-ci.org/sailorgeoffrey/ddp-client-java"><img src="https://travis-ci.org/sailorgeoffrey/ddp-client-java.png?branch=master" alt="Build Status"></a>
</h1>

<p><strong>"Meteor is an open-source platform for building top-quality web apps in a fraction of the time, whether you're an expert developer or just getting started."  <a href="https://www.meteor.com/">-Meteor Website</a></strong></p>

<p>This library allows Java developers to make clients for Meteor web applications that can take advantage of <a href="http://docs.meteor.com/#publishandsubscribe">data subscriptions</a> and published <a href="http://docs.meteor.com/#methods_header">RPC methods</a>.</p>

<h2>
<a name="quick-start" class="anchor" href="#quick-start"><span class="octicon octicon-link"></span></a>Quick Start</h2>

<p><strong>Note: This project requires JDK 1.8 and Gradle.</strong>
A backport to JDK 1.7 can be found in <a href="https://github.com/sailorgeoffrey/ddp-client-java/tree/jdk7">this branch</a></p>

<ul>
<li>Checkout this repo</li>
<li>Run the meteor app locally</li>
</ul><pre><code>cd examples/meteor-common
meteor
</code></pre>

<ul>
<li>Build and run a sample application</li>
</ul><pre><code>gradle jar
java -jar examples/simple-subscription/build/libs/simple-subscription.jar
</code></pre>

<ul>
<li>Open a web browser and go to http://localhost:3000</li>
<li>Enjoy!</li>
</ul><h2>
<a name="mavengradle-dependency" class="anchor" href="#mavengradle-dependency"><span class="octicon octicon-link"></span></a>Maven/Gradle Dependency</h2>

<p>Release versions of this library are published to the Maven Central Repository.
If you are using Maven, add the dependency to your pom.xml</p>

<div class="highlight highlight-xml"><pre>    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>io.advantageous.ddp<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>ddp-client<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>0.5.4<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>If you are using Gradle</p>

<div class="highlight highlight-groovy"><pre>    <span class="n">compile</span> <span class="s1">'io.advantageous.ddp:ddp-client:0.5.4'</span>
</pre></div>

<h2>
<a name="components" class="anchor" href="#components"><span class="octicon octicon-link"></span></a>Components</h2>

<p>This library can be described by breaking it into three main parts.</p>

<ul>
<li>Common Message Components</li>
<li>Subscription Adapters</li>
<li>RPC Client</li>
</ul><p>The package structure represents this grouping as well.</p>

<h3>
<a name="ddpmessageendpoint" class="anchor" href="#ddpmessageendpoint"><span class="octicon octicon-link"></span></a>DDPMessageEndpoint</h3>

<p>The message endpont is the websocket endpoint for all the DDP messages.  The endpoint is responsible for handling the
connection to the Meteor server and dispatching DDP messages to listeners.  Listeners are registered with the
registerHandler method.</p>

<p>The constructor takes two arguments: a javax.websocket.WebsocketContainer, and a MessageConverter.</p>

<div class="highlight highlight-java"><pre>    <span class="n">DDPMessageEndpoint</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DDPMessageEndpointImpl</span><span class="o">(</span><span class="n">webSocketContainer</span><span class="o">,</span> <span class="n">messageConverter</span><span class="o">);</span>

    <span class="n">endpoint</span><span class="o">.</span><span class="na">registerHandler</span><span class="o">(</span><span class="n">ConnectedMessage</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">message</span> <span class="o">-&gt;</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"connected to server! session: "</span> <span class="o">+</span> <span class="n">message</span><span class="o">.</span><span class="na">getSession</span><span class="o">()));</span>
</pre></div>

<h3>
<a name="messageconverter" class="anchor" href="#messageconverter"><span class="octicon octicon-link"></span></a>MessageConverter</h3>

<p>The message converter is what converts a DDP message into a strongly typed Java message object.  The only included
implementation is a JSONMessageConverter because the Meteor server uses JSON over websocket by default.  The reason this
was abstracted out of the main client is because one could potentially use another serialization strategy here.
(Google's Protocol Buffers, for example)</p>

<h3>
<a name="subscriptionadapter" class="anchor" href="#subscriptionadapter"><span class="octicon octicon-link"></span></a>SubscriptionAdapter</h3>

<p>A subscription adapter is responsible for subscribing and unsubscribing from collections and handling subscription
messages.  This library includes a MapSubscription adapter that updates a java.util.Map from subscription messages.  The
map is injected into the MapSubscriptionAdapter so that you can use a simple HashMap or any map provider. (Memcached,
JGroups, etc.)</p>

<p>You can also extend the BaseSubscriptionAdapter to use any other local storage.  (minimongo anyone?)</p>

<div class="highlight highlight-java"><pre>    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">dataMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="n">SubscriptionAdapter</span> <span class="n">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MapSubscriptionAdapter</span><span class="o">(</span>
            <span class="n">endpoint</span><span class="o">,</span>
            <span class="k">new</span> <span class="nf">JsonObjectConverter</span><span class="o">(),</span>
            <span class="n">dataMap</span>
    <span class="o">);</span>

    <span class="c1">// Subscribe to a collection when a connection is established</span>
    <span class="n">endpoint</span><span class="o">.</span><span class="na">registerHandler</span><span class="o">(</span><span class="n">ConnectedMessage</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">message</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">adapter</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="k">new</span> <span class="n">Subscription</span><span class="o">(</span><span class="s">"employees"</span><span class="o">,</span> <span class="n">Employee</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">});</span>

</pre></div>

<h3>
<a name="objectconverter" class="anchor" href="#objectconverter"><span class="octicon octicon-link"></span></a>ObjectConverter</h3>

<p>The object convert is what converts Added and Changed DDP messages into their mapped Java objects.  The only included
converter is a JSON converter, but an EJSON converter would be handy in the future.</p>

<h3>
<a name="rpcclient" class="anchor" href="#rpcclient"><span class="octicon octicon-link"></span></a>RPCClient</h3>

<p>The RPC client is used to call Meteor.method functions.  The call method requires callbacks for success and failure.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Meteor DDP Client for Java maintained by <a href="https://github.com/sailorgeoffrey">sailorgeoffrey</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-49038936-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
